# RSA
import rsa


def rsaEncrypt(message):
    '''
    RSA加密函数
    传入需要加密的内容，进行RSA加密，并返回密文 & 私钥 & 公钥
    :param message: 需要加密的内容，明文
    :return: 密文 & 私钥 & 公钥
    '''
    key_pub, key_pri = rsa.newkeys(1024)
    # print(key_pri)
    # print(key_pub)
    content = message.encode('utf-8')
    crypto = rsa.encrypt(content, key_pub)
    return (crypto, key_pri, key_pub)


def rsaDecrypt(message, key_pri):
    '''
    RSA 解密函数，传入密文 & 私钥，得到明文；
    :param message: 密文
    :param key_pri: 私钥
    :return: 明文
    '''
    content = rsa.decrypt(message, key_pri)
    return content.decode('utf-8')


# 公钥加密，私钥解密
def test():
    message = ""

    print('加密前：', message)  # 加密前： I Love China. 我爱你中国！

    crypto, key_pri, key_pub = rsaEncrypt(message)

    print('加密后：',
          crypto)  # 加密后： b';\x1fT\x0b\xa2\xc2t\x18\xf2z\x85p\t>\xdc@%\xd4\xf3>i1\xae\xe9=\x993>\xed!\xc9?F\xcb\xde\xe1\xa5\xf0\xe9\xde\xc3\x16\xf4W\x19;\x83B\x1c\xa7\xc8k\xc9EB\xdd\x94\xad7\xda\x7f{\xec\x9f\x99\xbfd\x87\xf0d\xbc\xfe\xef_\xd9;\x18s{l\xcb\xd5u\xb7/\xf4FX\xda\xd4\xa1\xe6\xce|\xe0[<\xe4\xe2j\xb9N\xc4\x93\x17\xe7J\xeey\xbd\x1a\xd8.\x0b)\xcb\x98\xc4\x96\xb9b\t\xdc\x18]2\xdfy'
    print('秘钥为：',
          key_pri)  # 秘钥为： PrivateKey(115288028345818733754881460912555806638911383959807908842585241310442843853213667112358247839422013848032677508051802527090846065467533765017680180661692630683981532520607475409309404078951405099846021972426884336220213989970308538119345752815652299922371343220268410359092002773721528507791837782603361434249, 65537, 72671372491785063554143583498765474892962268379138876088256082881055042532006497124961953957220544334895981514795123582047544773342223284047871955302686464986848482351432416996957016628407054177594256525025069157980131024957403886435812321512561610952210861350247053560059407031244790602637847816964556926465, 38939822841624334244626968212850549717962185656658548767156085704609096413636024697954233697763690441579951219223510491427663677756196233739375481382535403537584193, 2960671619249966096061431500671042485145295502851556909042124706260452571275538786999969819708964185223862037824834932783401994640273454183045193)
    print('公钥为：',
          key_pub)  # 公钥为： PublicKey(115288028345818733754881460912555806638911383959807908842585241310442843853213667112358247839422013848032677508051802527090846065467533765017680180661692630683981532520607475409309404078951405099846021972426884336220213989970308538119345752815652299922371343220268410359092002773721528507791837782603361434249, 65537)


    content = rsaDecrypt(crypto, key_pri)
    print('明文为：', content)  # 明文为： I Love China. 我爱你中国！
